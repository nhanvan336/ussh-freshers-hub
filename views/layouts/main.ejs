<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= typeof title !== 'undefined' ? title : "Trang ch·ªß" %> | USSH Freshers' Hub</title>
    <meta name="description" content="C·ªông ƒë·ªìng tr·ª±c tuy·∫øn d√†nh cho sinh vi√™n nƒÉm nh·∫•t Tr∆∞·ªùng ƒê·∫°i h·ªçc Khoa h·ªçc X√£ h·ªôi v√† Nh√¢n vƒÉn">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/components/navbar.css">
    <!-- Gi·∫£ ƒë·ªãnh b·∫°n c√≥ file CSS cho chatbot UI m·ªõi -->
    <link rel="stylesheet" href="/css/chatbot-ui.css"> 
    <link rel="stylesheet" href="/css/pages.css">
</head>
<body>
    <a href="#main-content" class="skip-link">Chuy·ªÉn ƒë·∫øn n·ªôi dung ch√≠nh</a>
    
    <%- include('../partials/header') %>
    
    <main id="main-content" class="main-content">
        <div class="container">
            <% if (locals.success_msg && success_msg.length > 0) { %>
                <div class="alert alert-success" role="alert"><%= success_msg %></div>
            <% } %>
            <% if (locals.error_msg && error_msg.length > 0) { %>
                <div class="alert alert-danger" role="alert"><%= error_msg %></div>
            <% } %>
            <% if (locals.error && error.length > 0) { %>
                <div class="alert alert-danger" role="alert"><%= error %></div>
            <% } %>

            <%- typeof body !== 'undefined' ? body : '' %>
        </div>
    </main>
    
    <%- include('../partials/footer') %>
    
    <!-- [THAY ƒê·ªîI] Thi·∫øt k·∫ø l·∫°i Widget Chatbot tƒ©nh theo file chatbot-ui.js c·ªßa b·∫°n -->
    <!-- N√∫t b·∫•m Chatbot -->
    <div class="chatbot-button">
        <div class="chatbot-button-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z" fill="currentColor"></path>
                <path d="M8.5 11C9.33 11 10 10.33 10 9.5C10 8.67 9.33 8 8.5 8C7.67 8 7 8.67 7 9.5C7 10.33 7.67 11 8.5 11Z" fill="currentColor"></path>
                <path d="M15.5 11C16.33 11 17 10.33 17 9.5C17 8.67 16.33 8 15.5 8C14.67 8 14 8.67 14 9.5C14 10.33 14.67 11 15.5 11Z" fill="currentColor"></path>
                <path d="M12 17.5C14.33 17.5 16.31 16.04 17 14H7C7.69 16.04 9.67 17.5 12 17.5Z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="chatbot-button-pulse"></div>
    </div>

    <!-- Khung Chatbot -->
    <div class="chatbot-widget">
        <div class="chatbot-header">
            <div class="chatbot-header-info">
                <div class="chatbot-avatar"><span>ü§ñ</span></div>
                <div class="chatbot-title">
                    <h4>USSH Assistant</h4>
                    <span class="chatbot-status">Online</span>
                </div>
            </div>
            <div class="chatbot-header-actions">
                <button class="chatbot-minimize" aria-label="Minimize">‚àí</button>
                <button class="chatbot-close" aria-label="Close">√ó</button>
            </div>
        </div>
        <div class="chatbot-messages" id="chatbot-messages">
            <div class="chatbot-welcome">
                <div class="welcome-message">
                    <h5>üëã Ch√†o m·ª´ng ƒë·∫øn v·ªõi USSH Assistant!</h5>
                    <p>T√¥i ·ªü ƒë√¢y ƒë·ªÉ gi√∫p b·∫°n. H√£y h·ªèi t√¥i v·ªÅ kh√≥a h·ªçc, di·ªÖn ƒë√†n, ho·∫∑c b·∫•t c·ª© ƒëi·ªÅu g√¨ kh√°c nh√©!</p>
                </div>
            </div>
        </div>
        <div class="chatbot-suggestions" id="chatbot-suggestions"></div>
        <div class="chatbot-typing" id="chatbot-typing" style="display: none;">
            <div class="typing-indicator"><span></span><span></span><span></span></div>
            <span class="typing-text">Tr·ª£ l√Ω ƒëang tr·∫£ l·ªùi...</span>
        </div>
        <div class="chatbot-input">
            <div class="chatbot-input-container">
                <textarea id="chatbot-input-field" placeholder="Nh·∫≠p tin nh·∫Øn c·ªßa b·∫°n..." rows="1" maxlength="1000"></textarea>
                <button id="chatbot-send-btn" class="chatbot-send-btn" aria-label="G·ª≠i tin nh·∫Øn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 21L23 12L2 3V10L17 12L2 14V21Z" fill="currentColor"></path>
                    </svg>
                </button>
            </div>
            <div class="chatbot-input-footer">
                <span class="char-count">0/1000</span>
                <span class="chatbot-tips">G√µ "/" ƒë·ªÉ xem l·ªánh</span>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/chatbot-ui.js"></script>
    
    <!-- Kh·ªüi t·∫°o c√°c service c·∫ßn thi·∫øt cho chatbot -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof io !== 'undefined') {
                window.realtimeService = {
                    socket: io(),
                    isConnected: true,
                    on: function(event, callback) { this.socket.on(event, callback); }
                };
            } else {
                 window.realtimeService = { isConnected: false };
            }
        });
    </script>
</body>
</html>

